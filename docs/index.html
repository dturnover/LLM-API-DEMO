<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>LLM API Demo</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; max-width: 800px; margin: auto; }
    #log { white-space: pre-wrap; border: 1px solid #ddd; border-radius: 10px; padding: 12px; min-height: 160px; }
    textarea { width: 100%; padding: 10px; }
    button { padding: 8px 14px; }
  </style>
</head>
<body>
  <h2>LLM API Demo</h2>

  <div id="log"></div>

  <div style="display:flex; gap:8px; margin-top:10px;">
    <textarea id="msg" rows="3" placeholder="Type your message..."></textarea>
    <button id="send">Send</button>
  </div>

  <script>
    const API_URL = "https://llm-api-demo-5qz1.onrender.com/chat"; // streaming endpoint

    const log = document.getElementById('log');
    const msg = document.getElementById('msg');
    const sendBtn = document.getElementById('send');

    function append(t){
      log.textContent += t;
      log.scrollTop = log.scrollHeight;
    }

    async function send(){
      const text = msg.value.trim(); if (!text) return;
      msg.value = "";
      append(`You: ${text}\n\nBot: `);

      try{
        const res = await fetch(API_URL, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ message: text })
        });
        if(!res.ok || !res.body){ append(`[error ${res.status}]\n\n`); return; }

        const reader = res.body.getReader();
        const decoder = new TextDecoder();
        while(true){
          const { value, done } = await reader.read();
          if(done) break;
          append(decoder.decode(value, { stream: true }));
        }
        append("\n\n");
      }catch(e){
        append(`[network error: ${e.message}]\n\n`);
      }
    }

    sendBtn.addEventListener('click', send);
    msg.addEventListener('keydown', (e) => {
      if (e.key === "Enter" && !e.shiftKey) { e.preventDefault(); send(); }
    });
  </script>
</body>
</html>

